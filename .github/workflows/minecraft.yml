name: Minecraft Updates to Discord

on:
  schedule:
    - cron: '0 */6 * * *'
  workflow_dispatch:

jobs:
  post_update:
    runs-on: ubuntu-latest

    steps:
      - name: Fetch Minecraft RSS
        run: |
          curl -s https://www.minecraft.net/en-us/feeds/community-content/rss > feed.xml

      - name: Send update to Discord
        env:
          WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        run: |
          TITLE=$(grep -m1 "<title>" feed.xml | sed 's/<[^>]*>//g')
          LINK=$(grep -m1 "<link>" feed.xml | sed 's/<[^>]*>//g')

          curl -H "Content-Type: application/json" \
          -X POST \
          -d "{\"content\":\"ðŸŸ¢ **Minecraft Update**\\n**$TITLE**\\n$LINK\"}" \
          $WEBHOOK

